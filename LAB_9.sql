CREATE TABLE AUTHOR
(
	AUTHORID INT PRIMARY KEY,
	AUTHORNAME VARCHAR(100) NOT NULL,
	COUNTRY VARCHAR(50)
)
INSERT INTO AUTHOR
VALUES
(1,'CHETAN BHAGAT','INDIA'),
(2,'ARUNDHATI ROY','INDIA'),
(3,'AMISH TRIPATHI','INDIA'),
(4,'RUSKIN BOND','INDIA'),
(5,'JHUMPA LAHIRI','INDIA'),
(6,'PAULO COELHO','BRAZIL'),
(7,'SUDHA MURTY','INDIA')
SELECT * FROM AUTHOR

CREATE TABLE PUBLISHER
(
	PUBLISHERID INT PRIMARY KEY,
	PUBLISHERNAME VARCHAR(100) NOT NULL UNIQUE,
	CITY VARCHAR(50) NOT NULL
)
INSERT INTO PUBLISHER
VALUES
(1,'RUPA PUBLICATIONS','NEW DELHI'),
(2,'PENGUIN INDIA','GURUGRAM'),
(3,'HARPERCOLLINS INDIA','NOIDA'),
(4,'ALEPH BOOK COMPANY','NEW DELHI')
SELECT * FROM PUBLISHER

CREATE TABLE BOOK
(
	BOOKID INT PRIMARY KEY,
	TITLE VARCHAR(200) NOT NULL,
	AUTHORID INT FOREIGN KEY REFERENCES AUTHOR(AUTHORID) NOT NULL,
	PUBLISHERID INT FOREIGN KEY REFERENCES PUBLISHER(PUBLISHERID) NOT NULL,
	PRICE DECIMAL(8,2) NOT NULL,
	PUBLICATIONYEAR INT NOT NULL
)
INSERT INTO BOOK
VALUES
(101,'FIVE POINT SOMEONE',1,1,250.00,2004),
(102,'THE GOD OF SMALL THINGS',2,2,350.00,1997),
(103,'IMMORTALS OF MELUHA',3,3,300.00,2010),
(104,'THE BLUE UMBRELLA',4,1,180.00,1980),
(105,'THE LOWLAND',5,2,400.00,2013),
(106,'REVOLUTION 2020',1,1,275.00,2011),
(107,'SITA: WARRIOR OF MITHILA',3,3,320.00,2017),
(108,'THE ROOM ON THE ROOF',4,4,200.00,1956)
SELECT * FROM BOOK



--PART :: A
--1.
SELECT B.* , A.AUTHORNAME FROM BOOK B JOIN AUTHOR A ON B.AUTHORID = A.AUTHORID
--2.
SELECT B.* , P.PUBLISHERNAME FROM BOOK B JOIN PUBLISHER P ON B.PUBLISHERID = P.PUBLISHERID
--3.
SELECT B.* , A.AUTHORNAME , P.PUBLISHERNAME FROM BOOK B 
JOIN AUTHOR A ON B.AUTHORID = A.AUTHORID
JOIN PUBLISHER P ON B.PUBLISHERID = P.PUBLISHERID
--4.
SELECT B.* , A.AUTHORNAME , P.PUBLISHERNAME FROM BOOK B 
JOIN AUTHOR A ON B.AUTHORID = A.AUTHORID
JOIN PUBLISHER P ON B.PUBLISHERID = P.PUBLISHERID WHERE B.PUBLICATIONYEAR > 2010
--5.
SELECT A.AUTHORNAME , COUNT(B.AUTHORID) FROM AUTHOR A LEFT OUTER JOIN BOOK B ON A.AUTHORID = B.AUTHORID GROUP BY A.AUTHORNAME
--6.
SELECT P.PUBLISHERNAME , SUM(B.PRICE) FROM PUBLISHER P LEFT OUTER JOIN BOOK B ON P.PUBLISHERID = B.PUBLISHERID GROUP BY P.PUBLISHERNAME
--7.
SELECT A.AUTHORNAME FROM AUTHOR A LEFT OUTER JOIN BOOK B ON A.AUTHORID = B.AUTHORID WHERE B.AUTHORID IS NULL
--8.
SELECT A.AUTHORNAME,COUNT(B.BOOKID),AVG(B.PRICE)FROM AUTHOR A LEFT OUTER JOIN BOOK B ON A.AUTHORID = B.AUTHORID GROUP BY A.AUTHORNAME
--9.
SELECT P.PUBLISHERNAME,COUNT(B.BOOKID) FROM PUBLISHER P LEFT OUTER JOIN BOOK B ON P.PUBLISHERID = B.PUBLISHERID GROUP BY P.PUBLISHERNAME
--10.
SELECT B.PUBLICATIONYEAR,COUNT(B.BOOKID) FROM BOOK B GROUP BY B.PUBLICATIONYEAR




--PART :: B
--1.
SELECT P.PUBLISHERNAME,SUM(B.PRICE) FROM PUBLISHER P 
JOIN BOOK B ON P.PUBLISHERID = B.PUBLISHERID
GROUP BY P.PUBLISHERNAME
HAVING SUM(B.PRICE) > 500
--2.
SELECT A.AUTHORNAME,MAX(B.PRICE)
FROM AUTHOR A
JOIN BOOK B ON A.AUTHORID = B.AUTHORID
GROUP BY A.AUTHORNAME



--PART :: C
--1.
CREATE TABLE EMP_INFO
(
	EID INT PRIMARY KEY,
	ENAME VARCHAR(100) NOT NULL,
	DID INT FOREIGN KEY REFERENCES DEPT_INFO(DID),
	CID INT FOREIGN KEY REFERENCES CITY_INFO(CID),
	SALARY DECIMAL(8,2),
	EXPERIENCE INT
)
CREATE TABLE DEPT_INFO
(
	DID INT PRIMARY KEY,
	DNAME VARCHAR(50) NOT NULL
)
CREATE TABLE CITY_INFO
(
	CID INT PRIMARY KEY,
	CNAME VARCHAR(50) NOT NULL,
	DID INT FOREIGN KEY REFERENCES DISTRICT(DID)
)
CREATE TABLE DISTRICT
(
	DID INT PRIMARY KEY,
	DNAME VARCHAR(50) NOT NULL,
	SID INT FOREIGN KEY REFERENCES STATE(SID)
)
CREATE TABLE STATE
(
	SID INT PRIMARY KEY,
	SNAME VARCHAR(50) NOT NULL,
	CID INT FOREIGN KEY REFERENCES COUNTRY(CID)
)
CREATE TABLE COUNTRY
(
	CID INT PRIMARY KEY,
	CNAME VARCHAR(50) NOT NULL
)
--2.
INSERT INTO COUNTRY
VALUES
(1,'INDIA'),
(2,'JAPAN'),
(3,'EUROPE'),
(4,'ENGLAND'),
(5,'SOUTH AFRICA')
SELECT * FROM COUNTRY
INSERT INTO STATE
VALUES
(01,'GUJARAT',1),
(02,'RAJASTHAN',1),
(03,'TOKYO',2),
(04,'KYOTO',2),
(05,'LONDON',4)
SELECT * FROM STATE
INSERT INTO DISTRICT
VALUES
(101,'RAJKOT',1),
(102,'JAIPUR',2),
(103,'SHIBUYA',3),
(104,'AHMEDABAD',1),
(105,'SHINJUKU',3)
SELECT * FROM DISTRICT
INSERT INTO CITY_INFO
VALUES
(101,'RAJKOT',101),
(102,'AHMEDABAD',104),
(103,'MITAKA',103),
(104,'GONDAL',101),
(105,'JAIPUR',102)
SELECT * FROM CITY_INFO
INSERT INTO DEPT_INFO
VALUES
(1,'ADMIN'),
(2,'HR'),
(3,'IT'),
(4,'MANAGEMENT'),
(5,'SECURITY')
SELECT * FROM DEPT_INFO
INSERT INTO EMP_INFO
VALUES
(1001,'RAJ',1,102,50000.00,5),
(1002,'PRUTHIL',3,101,40000.00,7),
(1003,'BHOOMI',4,104,20000.00,3),
(1004,'ASHOK',5,103,10000.00,4),
(1005,'MIRAL',3,101,40000.00,6)
SELECT * FROM EMP_INFO
--3.
SELECT EMP.ENAME , DEPT.DNAME , EMP.SALARY , EMP.EXPERIENCE , CITY.CNAME , DIS.DNAME , STA.SNAME , COU.CNAME FROM 
EMP_INFO EMP JOIN DEPT_INFO DEPT ON EMP.DID = DEPT.DID 
JOIN CITY_INFO CITY ON EMP.CID = CITY.CID
JOIN DISTRICT DIS ON CITY.DID = DIS.DID
JOIN STATE STA ON DIS.SID = STA.SID
JOIN COUNTRY COU ON STA.CID = COU.CID